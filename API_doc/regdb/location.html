<head>
<!-- Generated by perlmod2www.pl -->
<title>
location documentation.
</title>
</head>
<body bgcolor="white">
<HR><H4>regdb</H4>
<H3>location</H3>
<A NAME="TOP"></A>
<TABLE BORDER="1" WIDTH="100%"><TR>
<TD><A HREF="#vardefs">Package variables</A></TD>
<TD><A HREF="#SYNOPSIS">Synopsis</A></TD>
<TD><A HREF="#General">General documentation</A></TD>
<TD><A HREF="#Methods">Methods</A></TD>
</TR></TABLE><HR>
<A NAME="vardefs"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Package variables</B></TD>
<TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0" WIDTH="100%"><TR><TD COLSPAN="2">No package variables defined.</TD></TR>
</TABLE>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD WIDTH="150"><B>Included modules</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0"><TR><TD COLSPAN="2"><b><font color="#0000ff">Bio::Annotation::Collection</font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff">Bio::Annotation::Comment</font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff">Bio::Annotation::DBLink</font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff">Bio::Matrix::PSM::InstanceSite</font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff">Bio::Seq</font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff">Bio::Species</font></b> </TD></TR>
</TABLE>
<A NAME="SYNOPSIS"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Synopsis</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0"><TR><TD COLSPAN="2"><pre>Methods to load and store location data<BR>This is one of the biggest collection of methods for regdb<BR>Uses Bioperl (install bioperl-live)<BR></pre>
<pre> Title   : store_element_location<BR> Usage   : $regdb = $regdb-&gt;store_element_location($psm);<BR> Function: Stores location related data in regdb<BR> Returns : regdb object (enriched with current primary keys)<BR> Args    : Bio::Matrix::PSM::InstanceSite with complete information (including annotation)<BR> Notes   : Does not store TFBS_name and quality in reg_seq table and band in location<BR>            Look for explanation of the expected PSM data in the manual/howto<BR> To do   : Introduce checks.<BR></pre>
</TD></TR></TABLE>
<A NAME="DESCRIPTION"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Description</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0"><TR><TD COLSPAN="2"><FONT COLOR="RED">No description!</FONT></TD></TR></TABLE>
<A NAME="Methods"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Methods</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE>
<TABLE BORDER="1" CELLSPACING="5"><TR><TD><B>get_construct_by_name</B></TD><TD><A HREF="#POD1">Description</A></TD><TD><A HREF="#CODE1">Code</A></TD></TR>
<TR><TD><B>get_psm_by_regseqid</B></TD><TD><A HREF="#POD2">Description</A></TD><TD><A HREF="#CODE2">Code</A></TD></TR>
<TR><TD><B>get_psm_by_transcript_coordinates</B></TD><TD><A HREF="#POD3">Description</A></TD><TD><A HREF="#CODE3">Code</A></TD></TR>
<TR><TD><B>get_reg_seq_by_TF</B></TD><TD><A HREF="#POD4">Description</A></TD><TD><A HREF="#CODE4">Code</A></TD></TR>
<TR><TD><B>get_reg_seq_by_ref</B></TD><TD><A HREF="#POD5">Description</A></TD><TD><A HREF="#CODE5">Code</A></TD></TR>
<TR><TD><B>get_regseq_by_construct_id</B></TD><TD><A HREF="#POD6">Description</A></TD><TD><A HREF="#CODE6">Code</A></TD></TR>
<TR><TD><B>store_construct</B></TD><TD><A HREF="#POD7">Description</A></TD><TD><A HREF="#CODE7">Code</A></TD></TR>
<TR><TD><B>store_element_construct</B></TD><TD><A HREF="#POD8">Description</A></TD><TD><A HREF="#CODE8">Code</A></TD></TR>
<TR><TD><B>store_element_location</B></TD><TD><FONT COLOR="RED"><B>No description</B></FONT></TD><TD><A HREF="#CODE9">Code</A></TD></TR>
</TABLE>
<A NAME="MethDesc"></A>
<HR><H2>Methods description</H2>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_get_construct_by_name"></A><A NAME="POD1"></A><B>get_construct_by_name</B></TD><TD><A HREF="#CODE1">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD>prev</TD><TD><A HREF="#POD2">next</A></TD></TR></TABLE>
<pre> Title   : get_construct_by_name<BR> Usage   : <BR> Function: Gets data for all entries in the contruct table having the same construct name<BR>            the returned hash is indexed by the primary key (construct_id) and each entry is a ref to an array<BR> Returns : hash<BR> Args    : string<BR> Notes   : <BR> To do   :<BR></pre>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_get_psm_by_regseqid"></A><A NAME="POD2"></A><B>get_psm_by_regseqid</B></TD><TD><A HREF="#CODE2">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD><A HREF="#POD1">prev</A></TD><TD><A HREF="#POD3">next</A></TD></TR></TABLE>
<pre> Title   : get_psm_by_regseqid<BR> Usage   : <BR> Function: Gets Bioperl object with complete genome location data<BR> Returns : Bio::Matrix::PSM::InstanceSite with complete information (including annotation)<BR> Args    : reg_seq_id<BR> Notes   : <BR> To do   :<BR></pre>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_get_psm_by_transcript_coordinates"></A><A NAME="POD3"></A><B>get_psm_by_transcript_coordinates</B></TD><TD><A HREF="#CODE3">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD><A HREF="#POD2">prev</A></TD><TD><A HREF="#POD4">next</A></TD></TR></TABLE>
<pre> Title   : get_psm_by_transcript_coordinates<BR> Usage   : <BR> Function: Gets Bioperl object with complete genome location data, possibly many hits returned if many TSR <BR>            for this CRE exist<BR> Returns : array of Bio::Matrix::PSM::InstanceSite with complete information (including annotation)<BR> Args    : transcript id, coordinate id and gene accession number<BR> Notes   : <BR> To do   :<BR></pre>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_get_reg_seq_by_TF"></A><A NAME="POD4"></A><B>get_reg_seq_by_TF</B></TD><TD><A HREF="#CODE4">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD><A HREF="#POD3">prev</A></TD><TD><A HREF="#POD5">next</A></TD></TR></TABLE>
<pre> Title   : get_reg_seq_by_TF<BR> Usage   : <BR> Function: Get reg_seq primary keys, to which a TF complex of interest binds<BR> Returns : array of reg_seq ids<BR> Args    : TF_complex primary id<BR> Notes   : Not completely implemented and tested<BR> To do   : Checks, test<BR></pre>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_get_reg_seq_by_ref"></A><A NAME="POD5"></A><B>get_reg_seq_by_ref</B></TD><TD><A HREF="#CODE5">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD><A HREF="#POD4">prev</A></TD><TD><A HREF="#POD6">next</A></TD></TR></TABLE>
<pre> Title   : get_reg_seq_by_ref<BR> Usage   : <BR> Function: Get reg_seq primary keys, that are based on the query reference id<BR> Returns : array of reg_seq ids<BR> Args    : ref_id<BR> Notes   : <BR> To do   :<BR></pre>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_get_regseq_by_construct_id"></A><A NAME="POD6"></A><B>get_regseq_by_construct_id</B></TD><TD><A HREF="#CODE6">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD><A HREF="#POD5">prev</A></TD><TD><A HREF="#POD7">next</A></TD></TR></TABLE>
<pre> Title   : get_regseq_by_construct_id<BR> Usage   : <BR> Function: gets all reg_seqs that are associated with a particular construct<BR>            the returned hash is indexed by the primary key (reg_seq_id) and each entry is a ref to an array<BR> Returns : hash<BR> Args    : construct_id<BR> Notes   : <BR> To do   :<BR></pre>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_store_construct"></A><A NAME="POD7"></A><B>store_construct</B></TD><TD><A HREF="#CODE7">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD><A HREF="#POD6">prev</A></TD><TD><A HREF="#POD8">next</A></TD></TR></TABLE>
<pre> Title   : store_construct<BR> Usage   : <BR> Function: Stores a psm into regdb as a construct, links to a previously stored reg_seq<BR> Returns : regdb object (self)<BR> Args    : Bio::Matrix::PSM::InstanceSite<BR> Notes   : use table_insert if no reg_seq is available for this construct<BR> To do   : <BR> Exceptions : if previously no reg_seq has been stored<BR></pre>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_store_element_construct"></A><A NAME="POD8"></A><B>store_element_construct</B></TD><TD><A HREF="#CODE8">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD><A HREF="#POD7">prev</A></TD><TD><A HREF="#POD9">next</A></TD></TR></TABLE>
<pre> Title   : store_element_construct<BR> Usage   : $regdb = $regdb-&gt;store_element_construct($seq);<BR> Function: Stores data related to a construct<BR> Returns : regdb object (enriched with current primary keys)<BR> Args    : Bio::Matrix::PSM::InstanceSite with complete information (including annotation)<BR> Notes   : Does not store TFBS_name and quality in reg_seq table and band in location<BR> To do   : Introduce checks.<BR></pre>
<A NAME="MethCode"></A>
<HR><H2>Methods code</H2>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE1"></A><B>get_construct_by_name</B></TD><TD><A HREF="#POD1">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30">prev</TD><TD WIDTH="30"><A HREF="#CODE2">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>get_construct_by_name</b></font>
 {<pre><font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$self</font>=<font color="#4169e1"><b>shift</b></font>;
<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$name</font>=<font color="#4169e1"><b>shift</b></font>;
<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>current_handle<font color="#0000ff"><b>}</b></font>=<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>dbh<font color="#0000ff"><b>}</b></font>-&gt;<font color="#ff8204">prepare</font><font color="#0000ff"><b>(</b></font><font color="#007400">"select construct_id from construct where construct_name=?"</font><font color="#0000ff"><b>)</b></font>;
<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>current_handle<font color="#0000ff"><b>}</b></font>-&gt;<font color="#ff8204">execute</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$name</font><font color="#0000ff"><b>)</b></font>;
<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">%res</font>;
<font color="#0000ff"><b>while</b></font> <font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$pkey</font>=<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>current_handle<font color="#0000ff"><b>}</b></font>-&gt;fetchrow_array<font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@data</font>=<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">get_data_by_primary_key</font><font color="#0000ff"><b>(</b></font><font color="#007400">'construct'</font>,<font color="#1f32ff">$pkey</font><font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$res</font><font color="#0000ff"><b>{</b></font><font color="#1f32ff">$pkey</font><font color="#0000ff"><b>}</b></font>=\<font color="#1f32ff">@data</font>; <font color="#ff0000">##Indexed by primary key..</font><BR><font color="#0000ff"><b>}</b></font>
<font color="#0000ff"><b>return</b></font> <font color="#1f32ff">%res</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE2"></A><B>get_psm_by_regseqid</B></TD><TD><A HREF="#POD2">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE1">prev</A></TD><TD WIDTH="30"><A HREF="#CODE3">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>get_psm_by_regseqid</b></font>
 {<pre><font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>,<font color="#1f32ff">$id</font><font color="#0000ff"><b>)</b></font>=<font color="#1f32ff">@_</font>;
<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@rseqdat</font>=<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">get_data_by_primary_key</font><font color="#0000ff"><b>(</b></font><font color="#007400">'reg_seq'</font>,<font color="#1f32ff">$id</font><font color="#0000ff"><b>)</b></font>;
<font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">get_psm_by_transcript_coordinates</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$rseqdat</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>,<font color="#1f32ff">$rseqdat</font><font color="#0000ff"><b>[</b></font>2<font color="#0000ff"><b>]</b></font><font color="#0000ff"><b>)</b></font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE3"></A><B>get_psm_by_transcript_coordinates</B></TD><TD><A HREF="#POD3">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE2">prev</A></TD><TD WIDTH="30"><A HREF="#CODE4">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>get_psm_by_transcript_coordinates</b></font>
 {<pre><font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>,<font color="#1f32ff">$tid</font>,<font color="#1f32ff">$coordid</font>,<font color="#1f32ff">$geneaccn</font><font color="#0000ff"><b>)</b></font>=<font color="#1f32ff">@_</font>;
<font color="#0000ff"><b>return</b></font> <font color="#4169e1"><b>undef</b></font> <font color="#0000ff"><b>unless</b></font> <font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$tid</font><font color="#0000ff"><b>)</b></font>&amp;&amp;<font color="#0000ff"><b>(</b></font><font color="#1f32ff">$coordid</font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font>;
<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@tdata</font>=<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">get_data_by_primary_key</font><font color="#0000ff"><b>(</b></font><font color="#007400">'transcript'</font>,<font color="#1f32ff">$tid</font><font color="#0000ff"><b>)</b></font>;
<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@coord</font>=<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">get_data_by_primary_key</font><font color="#0000ff"><b>(</b></font><font color="#007400">'coordinate'</font>,<font color="#1f32ff">$coordid</font><font color="#0000ff"><b>)</b></font>;
<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@loc</font>=<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">get_data_by_primary_key</font><font color="#0000ff"><b>(</b></font><font color="#007400">'location'</font>,<font color="#1f32ff">$coord</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font><font color="#0000ff"><b>)</b></font>;
<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@dbsource</font>=<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">get_data_by_primary_key</font><font color="#0000ff"><b>(</b></font><font color="#007400">'db_source'</font>,<font color="#1f32ff">$loc</font><font color="#0000ff"><b>[</b></font>2<font color="#0000ff"><b>]</b></font><font color="#0000ff"><b>)</b></font>;
<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$tsrh1</font>=<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>dbh<font color="#0000ff"><b>}</b></font>-&gt;<font color="#ff8204">prepare</font><font color="#0000ff"><b>(</b></font><font color="#007400">"select reg_seq_id, sequence from tsr a, tsr_reg_seq b where transcript_id=? and gene_source_id=?
                                    and a.tsr_id=b.tsr_id"</font><font color="#0000ff"><b>)</b></font>||<font color="#4169e1"><b>die</b></font>;
<font color="#1f32ff">$tsrh1</font>-&gt;<font color="#ff8204">execute</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$tid</font>,<font color="#1f32ff">$tdata</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font><font color="#0000ff"><b>)</b></font>||<font color="#4169e1"><b>die</b></font>;
<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$all</font>=<font color="#1f32ff">$tsrh1</font>-&gt;fetchall_arrayref;
<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@psm</font>;
<font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$row</font> <font color="#0000ff"><b>(</b></font>@$all<font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
   <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$rsid</font>,<font color="#1f32ff">$seq</font><font color="#0000ff"><b>)</b></font>=@$row;
    <font color="#1f32ff">$seq</font>=~s<font color="#006400"><b>/\W/</b></font><font color="#006400"><b>/g; #Fix for non-compatible data, EOL, etc.<BR>#Basic PSM object here, accession number is always reg_seq_id!!!<BR>my </b></font><font color="#1f32ff">$psm</font><font color="#006400"><b>=new Bio::Matrix::PSM::InstanceSite(-start=&gt;</b></font><font color="#1f32ff">$coord</font><font color="#006400"><b>[2],-end=&gt;</b></font><font color="#1f32ff">$coord</font><font color="#006400"><b>[3],-strand=&gt;</b></font><font color="#1f32ff">$coord</font><font color="#006400"><b>[1]=='+'?1:-1, -accession_number=&gt;</b></font><font color="#1f32ff">$rsid</font><font color="#006400"><b>,<BR>                                            -desc=&gt;</b></font><font color="#1f32ff">$gene</font><font color="#006400"><b>[0], -anchor=&gt;</b></font><font color="#1f32ff">$loc</font><font color="#006400"><b>[6], -seq=&gt;</b></font><font color="#1f32ff">$seq</font><font color="#006400"><b>, -id=&gt;</b></font><font color="#1f32ff">$geneaccn</font>);<BR>my <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$gen</font>,<font color="#1f32ff">$species</font><font color="#0000ff"><b>)</b></font>=<font color="#4169e1"><b>split</b></font><font color="#0000ff"><b>(</b></font><font color="#006400"><b>/\s/</b></font>,<font color="#1f32ff">$loc</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font><font color="#0000ff"><b>)</b></font>;
<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$sp</font>=<font color="#0000ff"><b>new</b></font> <font color="#8000ff"><b>Bio</b></font>::<font color="#ff8204">Species</font><font color="#0000ff"><b>(</b></font>-classification=&gt;<font color="#0000ff"><b>[</b></font><font color="#1f32ff">$species</font>,<font color="#1f32ff">$gen</font><font color="#0000ff"><b>]</b></font><font color="#0000ff"><b>)</b></font>;
<font color="#1f32ff">$psm</font>-&gt;<font color="#ff8204">species</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$sp</font><font color="#0000ff"><b>)</b></font>;
<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$dblink</font>= <font color="#0000ff"><b>new</b></font> <font color="#8000ff"><b>Bio::Annotation</b></font>::<font color="#ff8204">DBLink</font><font color="#0000ff"><b>(</b></font>-database=&gt;<font color="#1f32ff">$dbsource</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>,-namespace=&gt;<font color="#1f32ff">$dbsource</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>,-primary_id=&gt;<font color="#1f32ff">$tdata</font><font color="#0000ff"><b>[</b></font>2<font color="#0000ff"><b>]</b></font>,-version=&gt;<font color="#1f32ff">$tdata</font><font color="#0000ff"><b>[</b></font>3<font color="#0000ff"><b>]</b></font>,
                                        -optional_id=&gt;<font color="#1f32ff">$geneaccn</font><font color="#0000ff"><b>)</b></font>;
<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$comm</font>= <font color="#0000ff"><b>new</b></font> <font color="#8000ff"><b>Bio::Annotation</b></font>::<font color="#ff8204">Comment</font><font color="#0000ff"><b>(</b></font>-text=&gt;<font color="#1f32ff">$tdata</font><font color="#0000ff"><b>[</b></font>4<font color="#0000ff"><b>]</b></font><font color="#0000ff"><b>)</b></font>;
<font color="#1f32ff">$dblink</font>-&gt;<font color="#ff8204">comment</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$comm</font><font color="#0000ff"><b>)</b></font>;
<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$ann</font>= <font color="#0000ff"><b>new</b></font> <font color="#8000ff"><b>Bio::Annotation</b></font>::<font color="#ff8204">Collection</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;
<font color="#1f32ff">$ann</font>-&gt;<font color="#ff8204">add_Annotation</font><font color="#0000ff"><b>(</b></font><font color="#007400">'dblink'</font>,<font color="#1f32ff">$dblink</font><font color="#0000ff"><b>)</b></font>;
<font color="#1f32ff">$psm</font>-&gt;<font color="#ff8204">annotation</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$ann</font><font color="#0000ff"><b>)</b></font>;
<font color="#4169e1"><b>push</b></font> <font color="#1f32ff">@psm</font>,<font color="#1f32ff">$psm</font>;
<font color="#0000ff"><b>}</b></font>
<font color="#0000ff"><b>return</b></font> <font color="#1f32ff">@psm</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE4"></A><B>get_reg_seq_by_TF</B></TD><TD><A HREF="#POD4">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE3">prev</A></TD><TD WIDTH="30"><A HREF="#CODE5">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>get_reg_seq_by_TF</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>,<font color="#1f32ff">$tfid</font><font color="#0000ff"><b>)</b></font>=<font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">%rs</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$iotype</font>=<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">get_IO_type_id</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$tfid</font>,<font color="#007400">'tf_complex'</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$inputh</font>=<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">prepare</font><font color="#0000ff"><b>(</b></font><font color="#007400">"select input_id from analysis_input where io_type_id=?"</font><font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$inputh</font>-&gt;<font color="#ff8204">execute</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$iotype</font><font color="#0000ff"><b>)</b></font>||<font color="#4169e1"><b>die</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$input</font>=<font color="#1f32ff">$inputh</font>-&gt;fetchrow_array;
    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$links</font>,<font color="#1f32ff">$olinks</font><font color="#0000ff"><b>)</b></font>=<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">get_iolinks_for_input</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$input</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$ilink</font> <font color="#0000ff"><b>(</b></font>@$ilinks<font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
        
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">%rs</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE5"></A><B>get_reg_seq_by_ref</B></TD><TD><A HREF="#POD5">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE4">prev</A></TD><TD WIDTH="30"><A HREF="#CODE6">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>get_reg_seq_by_ref</b></font>
 {<pre>    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>,<font color="#1f32ff">$ref</font><font color="#0000ff"><b>)</b></font>=<font color="#1f32ff">@_</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@aid</font>=<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">get_analysis_by_ref</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$ref</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@rs</font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$ioh</font>=<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">prepare</font><font color="#0000ff"><b>(</b></font><font color="#007400">"select io_element_id from io_type a, analysis_input b where a.io_type_id=b.io_type_id
                                and IO_element_type='reg_seq' and analysis_id=?"</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$analysis</font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">@aid</font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
        <font color="#1f32ff">$ioh</font>-&gt;<font color="#ff8204">execute</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$analysis</font><font color="#0000ff"><b>)</b></font>||<font color="#4169e1"><b>die</b></font>;
        <font color="#0000ff"><b>while</b></font> <font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$io</font>=<font color="#1f32ff">$ioh</font>-&gt;fetchrow_array<font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
            <font color="#4169e1"><b>push</b></font> <font color="#1f32ff">@rs</font>,<font color="#1f32ff">$io</font>;
        <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">@rs</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE6"></A><B>get_regseq_by_construct_id</B></TD><TD><A HREF="#POD6">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE5">prev</A></TD><TD WIDTH="30"><A HREF="#CODE7">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>get_regseq_by_construct_id</b></font>
 {<pre><font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$self</font>=<font color="#4169e1"><b>shift</b></font>;
<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$key</font>=<font color="#4169e1"><b>shift</b></font>;
<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>current_handle<font color="#0000ff"><b>}</b></font>=<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>dbh<font color="#0000ff"><b>}</b></font>-&gt;<font color="#ff8204">prepare</font><font color="#0000ff"><b>(</b></font><font color="#007400">"select reg_seq_construct_id from reg_seq_construct where construct_id=?"</font><font color="#0000ff"><b>)</b></font>;
<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>current_handle<font color="#0000ff"><b>}</b></font>-&gt;<font color="#ff8204">execute</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$key</font><font color="#0000ff"><b>)</b></font>;
<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">%res</font>;
<font color="#0000ff"><b>while</b></font> <font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$pkey</font>=<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>current_handle<font color="#0000ff"><b>}</b></font>-&gt;fetchrow_array<font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@data</font>=<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">get_data_by_primary_key</font><font color="#0000ff"><b>(</b></font><font color="#007400">'reg_seq_construct'</font>,<font color="#1f32ff">$pkey</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$nkey</font>=<font color="#1f32ff">$data</font><font color="#0000ff"><b>[</b></font>1<font color="#0000ff"><b>]</b></font>;<font color="#ff0000">##regseq_id key</font><BR>    <font color="#4169e1"><b>push</b></font> <font color="#1f32ff">@data</font>, <font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">get_data_by_primary_key</font><font color="#0000ff"><b>(</b></font><font color="#007400">'reg_seq'</font>,<font color="#1f32ff">$nkey</font><font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$res</font><font color="#0000ff"><b>{</b></font><font color="#1f32ff">$nkey</font><font color="#0000ff"><b>}</b></font>=\<font color="#1f32ff">@data</font>; <font color="#ff0000">##Indexed by primary key..</font><BR><font color="#0000ff"><b>}</b></font>
<font color="#0000ff"><b>return</b></font> <font color="#1f32ff">%res</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE7"></A><B>store_construct</B></TD><TD><A HREF="#POD7">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE6">prev</A></TD><TD WIDTH="30"><A HREF="#CODE8">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>store_construct</b></font>
 {<pre><font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$self</font>=<font color="#4169e1"><b>shift</b></font>;
<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$cseq</font>=<font color="#4169e1"><b>shift</b></font>;
<font color="#4169e1"><b>die</b></font> <font color="#007400">"No reg_seq to link to"</font> <font color="#0000ff"><b>unless</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>reg_seq_id<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>;
<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>construct_id<font color="#0000ff"><b>}</b></font>=<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">table_insert</font><font color="#0000ff"><b>(</b></font><font color="#007400">'construct'</font>,<font color="#1f32ff">$cseq</font>-&gt;id,<font color="#1f32ff">$cseq</font>-&gt;desc,<font color="#1f32ff">$cseq</font>-&gt;seq<font color="#0000ff"><b>)</b></font>;
<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>reg_seq_construct_id<font color="#0000ff"><b>}</b></font>=<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">table_insert</font><font color="#0000ff"><b>(</b></font><font color="#007400">'reg_seq_construct'</font>,<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>construct_id<font color="#0000ff"><b>}</b></font>,<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>reg_seq_id<font color="#0000ff"><b>}</b></font>,<font color="#007400">'Web interface ORNL'</font><font color="#0000ff"><b>)</b></font>;
<font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$self</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE8"></A><B>store_element_construct</B></TD><TD><A HREF="#POD8">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE7">prev</A></TD><TD WIDTH="30"><A HREF="#CODE9">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>store_element_construct</b></font>
 {<pre><font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>,<font color="#1f32ff">$seq</font><font color="#0000ff"><b>)</b></font>=<font color="#1f32ff">@_</font>;
<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$comment</font>;
<font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$entry</font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">annotation</font><font color="#0000ff"><b>(</b></font><font color="#007400">'Comment'</font><font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
    <font color="#1f32ff">$comment</font> .= <font color="#1f32ff">$entry</font>;
<font color="#0000ff"><b>}</b></font>
<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>construct_id<font color="#0000ff"><b>}</b></font>=<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">table_insert</font><font color="#0000ff"><b>(</b></font><font color="#007400">'construct'</font>,<font color="#1f32ff">$seq</font>-&gt;id,<font color="#1f32ff">$seq</font>-&gt;desc,<font color="#1f32ff">$seq</font>-&gt;seq<font color="#0000ff"><b>)</b></font>;
<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>reg_seq_construct_id<font color="#0000ff"><b>}</b></font>=<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">table_insert</font><font color="#0000ff"><b>(</b></font><font color="#007400">'reg_seq_construct'</font>,<font color="#1f32ff">$seq</font>-&gt;<font color="#0000ff"><b>{</b></font>construct_id<font color="#0000ff"><b>}</b></font>,<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>reg_seq_id<font color="#0000ff"><b>}</b></font>,<font color="#1f32ff">$comment</font><font color="#0000ff"><b>)</b></font>;
<font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$self</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE9"></A><B>store_element_location</B></TD><TD>description</TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE8">prev</A></TD><TD WIDTH="30">next</TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>store_element_location</b></font>
 {<pre><font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$self</font>=<font color="#4169e1"><b>shift</b></font>;
<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$psm</font>=<font color="#4169e1"><b>shift</b></font>;
<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$ann</font>=<font color="#1f32ff">$psm</font>-&gt;annotation;
<font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$dbid</font>,<font color="#1f32ff">$dbaccn</font>,<font color="#1f32ff">$dbname</font>,<font color="#1f32ff">$dbsubset</font>,<font color="#1f32ff">$genedb</font>,<font color="#1f32ff">$tbuild</font>,<font color="#1f32ff">$tdb</font>,<font color="#1f32ff">$tsubset</font>,<font color="#1f32ff">$fstart</font>,<font color="#1f32ff">$fend</font>,<font color="#1f32ff">$start</font><font color="#0000ff"><b>)</b></font>;
<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@gdesc</font>=<font color="#1f32ff">$ann</font>-&gt;<font color="#ff8204">get_Annotations</font><font color="#0000ff"><b>(</b></font><font color="#007400">'GeneDescription'</font><font color="#0000ff"><b>)</b></font>;
<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@st</font>=<font color="#1f32ff">$ann</font>-&gt;<font color="#ff8204">get_Annotations</font><font color="#0000ff"><b>(</b></font><font color="#007400">'FuzzyStart'</font><font color="#0000ff"><b>)</b></font>;
<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@end</font>=<font color="#1f32ff">$ann</font>-&gt;<font color="#ff8204">get_Annotations</font><font color="#0000ff"><b>(</b></font><font color="#007400">'FuzzyEnd'</font><font color="#0000ff"><b>)</b></font>;
<font color="#1f32ff">$fend</font>=<font color="#1f32ff">$end</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>;
<font color="#1f32ff">$fstart</font>=<font color="#1f32ff">$st</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>;
<font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$fend</font>==<font color="#1f32ff">$fstart</font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
    <font color="#1f32ff">$start</font>=<font color="#1f32ff">$fstart</font>;
<font color="#0000ff"><b>}</b></font>
<font color="#0000ff"><b>else</b></font> <font color="#0000ff"><b>{</b></font>
 <font color="#1f32ff">$start</font>=<font color="#4169e1"><b>int</b></font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$fend</font>+<font color="#1f32ff">$fstart</font><font color="#0000ff"><b>)</b></font><font color="#006400"><b>/2); #Primitive- best if we have a distribution<BR>}<BR>my </b></font><font color="#1f32ff">$cdesc</font><font color="#006400"><b>=</b></font><font color="#1f32ff">$cdesc</font><font color="#006400"><b>[0]-&gt;value if (</b></font><font color="#1f32ff">@cdesc</font><font color="#006400"><b>);#We'll need thhis later, let's not do the constructs right now<BR>my </b></font><font color="#1f32ff">$gdesc</font><font color="#006400"><b>=</b></font><font color="#1f32ff">$gdesc</font><font color="#006400"><b>[0]-&gt;value if (</b></font><font color="#1f32ff">@gdesc</font>);<BR>foreach <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$dblink</font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$ann</font>-&gt;<font color="#ff8204">get_Annotations</font><font color="#0000ff"><b>(</b></font>DBLink<font color="#0000ff"><b>)</b></font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
    <font color="#1f32ff">$dbname</font>=<font color="#1f32ff">$dblink</font>-&gt;database||<font color="#007400">''</font>;
    <font color="#1f32ff">$dbsubset</font>=<font color="#1f32ff">$dblink</font>-&gt;namespace||<font color="#007400">''</font>;
    <font color="#1f32ff">$build</font>=<font color="#1f32ff">$dblink</font>-&gt;authority||<font color="#007400">''</font>;
 <font color="#ff0000">##   $dbid=$dblink-&gt;iaccession_number;</font><BR>    <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$dblink</font>-&gt;comment<font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font> <font color="#1f32ff">$locationcomment</font>=<font color="#1f32ff">$dblink</font>-&gt;comment-&gt;text ;<font color="#0000ff"><b>}</b></font> <font color="#0000ff"><b>else</b></font> <font color="#0000ff"><b>{</b></font><font color="#1f32ff">$locationcomment</font>=<font color="#007400">''</font>;<font color="#0000ff"><b>}</b></font>
    <font color="#1f32ff">$isoform</font>=<font color="#1f32ff">$dblink</font>-&gt;version||<font color="#007400">''</font>;
        <font color="#0000ff"><b>if</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$psm</font>-&gt;id <font color="#0000ff"><b>eq</b></font> <font color="#1f32ff">$dblink</font>-&gt;primary_id<font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font><font color="#ff0000">##We have the unique transcript id here</font><BR>        <font color="#1f32ff">$tdb</font>=<font color="#1f32ff">$dblink</font>-&gt;database;
        <font color="#1f32ff">$tbuild</font>=<font color="#1f32ff">$dblink</font>-&gt;authority;
    <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>else</b></font> <font color="#0000ff"><b>{</b></font>
        <font color="#1f32ff">$dbaccn</font>=<font color="#1f32ff">$dblink</font>-&gt;primary_id||<font color="#007400">''</font>;
        <font color="#1f32ff">$genedb</font>=<font color="#1f32ff">$dblink</font>-&gt;database;
    <font color="#0000ff"><b>}</b></font>
<font color="#0000ff"><b>}</b></font>
<font color="#ff0000">##Hmmm... I would prefer strand to be numeric...</font><BR> <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>DB_source_id<font color="#0000ff"><b>}</b></font>=<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">table_insert</font><font color="#0000ff"><b>(</b></font><font color="#007400">'db_source'</font>,<font color="#1f32ff">$dbname</font>,<font color="#1f32ff">$dbsubset</font><font color="#0000ff"><b>)</b></font>;
<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$gsrcid</font>=<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">table_insert</font><font color="#0000ff"><b>(</b></font><font color="#007400">'db_source'</font>,<font color="#1f32ff">$genedb</font>,<font color="#1f32ff">$genedb</font><font color="#0000ff"><b>)</b></font>;
 <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>location_id<font color="#0000ff"><b>}</b></font>=<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">table_insert</font><font color="#0000ff"><b>(</b></font><font color="#007400">'location'</font>,<font color="#1f32ff">$psm</font>-&gt;species-&gt;binomial,0,<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>DB_source_id<font color="#0000ff"><b>}</b></font>,<font color="#1f32ff">$build</font>,<font color="#1f32ff">$psm</font>-&gt;anchor<font color="#0000ff"><b>)</b></font>;
  <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>gene_source_id<font color="#0000ff"><b>}</b></font>=<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">table_insert</font><font color="#0000ff"><b>(</b></font><font color="#007400">'gene_source'</font>,<font color="#1f32ff">$gsrcid</font>,<font color="#1f32ff">$dbaccn</font>,<font color="#1f32ff">$psm</font>-&gt;desc<font color="#0000ff"><b>)</b></font>;
 <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>coordinate_id<font color="#0000ff"><b>}</b></font>=<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">table_insert</font><font color="#0000ff"><b>(</b></font><font color="#007400">'coordinate'</font>,<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>location_id<font color="#0000ff"><b>}</b></font>,<font color="#1f32ff">$psm</font>-&gt;strand==1?<font color="#007400">'+'</font>:<font color="#007400">'-'</font>,<font color="#1f32ff">$psm</font>-&gt;start,<font color="#1f32ff">$psm</font>-&gt;end,<font color="#1f32ff">$psm</font>-&gt;<font color="#4169e1"><b>length</b></font><font color="#0000ff"><b>)</b></font>;
 <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>transcript_id<font color="#0000ff"><b>}</b></font>=<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">table_insert</font><font color="#0000ff"><b>(</b></font><font color="#007400">'transcript'</font>,<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>gene_source_id<font color="#0000ff"><b>}</b></font>,<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>DB_source_id<font color="#0000ff"><b>}</b></font>,<font color="#1f32ff">$dbaccn</font>,<font color="#1f32ff">$isoform</font>,<font color="#1f32ff">$locationcomment</font><font color="#0000ff"><b>)</b></font>;
 <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>TSR_id<font color="#0000ff"><b>}</b></font>=<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">table_insert</font><font color="#0000ff"><b>(</b></font><font color="#007400">'tsr'</font>,<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>gene_source_id<font color="#0000ff"><b>}</b></font>,<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>transcript_id<font color="#0000ff"><b>}</b></font>,<font color="#1f32ff">$fstart</font>,<font color="#1f32ff">$fend</font>,<font color="#1f32ff">$start</font><font color="#0000ff"><b>)</b></font>;
 <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>reg_seq_id<font color="#0000ff"><b>}</b></font>=<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">table_insert</font><font color="#0000ff"><b>(</b></font><font color="#007400">'reg_seq'</font>,<font color="#4169e1"><b>undef</b></font>,<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>coordinate_id<font color="#0000ff"><b>}</b></font>,<font color="#1f32ff">$psm</font>-&gt;seq,<font color="#007400">'na'</font><font color="#0000ff"><b>)</b></font>;
 <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>TSR_reg_seq_id<font color="#0000ff"><b>}</b></font>=<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">table_insert</font><font color="#0000ff"><b>(</b></font><font color="#007400">'anchor_reg_seq'</font>,<font color="#4169e1"><b>undef</b></font>,<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>TSR_id<font color="#0000ff"><b>}</b></font>,<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>reg_seq_id<font color="#0000ff"><b>}</b></font><font color="#0000ff"><b>)</b></font>;<font color="#ff0000">##Should go through all possible TSRs..., important!</font><BR><font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$self</font>;</pre>}<BR>
<A NAME="General"></A>
<HR><H2>General documentation</H2>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
</TABLE>
<B>No general documentation available.</B><BR>
</body>
</html>
