<head>
<!-- Generated by perlmod2www.pl -->
<title>
gene documentation.
</title>
</head>
<body bgcolor="white">
<HR><H4>regdb</H4>
<H3>gene</H3>
<A NAME="TOP"></A>
<TABLE BORDER="1" WIDTH="100%"><TR>
<TD><A HREF="#SUMMARY">Summary</A></TD>
<TD><A HREF="#vardefs">Package variables</A></TD>
<TD><A HREF="#General">General documentation</A></TD>
<TD><A HREF="#Methods">Methods</A></TD>
</TR></TABLE><HR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR><TD BGCOLOR="#ffae84"><B>Summary</B></TD></TR>
</TABLE>
<TABLE BORDER="0" WIDTH="100%"><TR><TD><pre>gene: methods to access gene data, higher level than location methods<BR><BR>head1 SYNOPSIS<BR><BR>Methods to load and store gene data<BR>Uses Bioperl (install bioperl-live)<BR></pre></TD></TR>
</TABLE>
<A NAME="vardefs"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Package variables</B></TD>
<TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0" WIDTH="100%"><TR><TD COLSPAN="2">No package variables defined.</TD></TR>
</TABLE>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD WIDTH="150"><B>Included modules</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0"><TR><TD COLSPAN="2"><b><font color="#0000ff">Bio::Annotation::Collection</font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff">Bio::Annotation::Comment</font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff">Bio::Annotation::DBLink</font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff">Bio::Matrix::PSM::InstanceSite</font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff">Bio::Seq</font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff">Bio::Species</font></b> </TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff">Carp</font></b></TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff"><a href="../regdb.html">regdb</a></font></b></TD></TR>
<TR><TD COLSPAN="2"><b><font color="#0000ff"><a href="IO.html">regdb::IO</a></font></b> </TD></TR>
</TABLE>
<A NAME="SYNOPSIS"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Synopsis</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0"><TR><TD COLSPAN="2"><FONT COLOR="RED">No synopsis!</FONT></TD></TR></TABLE>
<A NAME="DESCRIPTION"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Description</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE><TABLE BORDER="0"><TR><TD COLSPAN="2"><FONT COLOR="RED">No description!</FONT></TD></TR></TABLE>
<A NAME="Methods"></A>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0"><TR BGCOLOR="#ffae84"><TD><B>Methods</B></TD><TD ALIGN="RIGHT"><A HREF="#TOP">top</A></TD></TR></TABLE>
<TABLE BORDER="1" CELLSPACING="5"><TR><TD><B>_get_regseq_data_by_transcr_id</B></TD><TD><A HREF="#POD1">Description</A></TD><TD><A HREF="#CODE1">Code</A></TD></TR>
<TR><TD><B>_get_transcript_data_by_gene_id</B></TD><TD><A HREF="#POD2">Description</A></TD><TD><A HREF="#CODE2">Code</A></TD></TR>
<TR><TD><B>get_all_gene_locations</B></TD><TD><A HREF="#POD3">Description</A></TD><TD><A HREF="#CODE3">Code</A></TD></TR>
<TR><TD><B>get_analysis_id_by_gene</B></TD><TD><A HREF="#POD4">Description</A></TD><TD><A HREF="#CODE4">Code</A></TD></TR>
<TR><TD><B>get_gene_by_regseq</B></TD><TD><A HREF="#POD5">Description</A></TD><TD><A HREF="#CODE5">Code</A></TD></TR>
<TR><TD><B>get_psms_by_accn</B></TD><TD><A HREF="#POD6">Description</A></TD><TD><A HREF="#CODE6">Code</A></TD></TR>
<TR><TD><B>store_gene_data</B></TD><TD><A HREF="#POD7">Description</A></TD><TD><A HREF="#CODE7">Code</A></TD></TR>
</TABLE>
<A NAME="MethDesc"></A>
<HR><H2>Methods description</H2>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod__get_regseq_data_by_transcr_id"></A><A NAME="POD1"></A><B>_get_regseq_data_by_transcr_id</B></TD><TD><A HREF="#CODE1">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD>prev</TD><TD><A HREF="#POD2">next</A></TD></TR></TABLE>
<pre> Usage   : <BR> Returns : <BR> Args    : <BR> Warnings: <BR> Todo   : Introduce checks<BR></pre>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod__get_transcript_data_by_gene_id"></A><A NAME="POD2"></A><B>_get_transcript_data_by_gene_id</B></TD><TD><A HREF="#CODE2">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD><A HREF="#POD1">prev</A></TD><TD><A HREF="#POD3">next</A></TD></TR></TABLE>
<pre> Usage   : <BR> Returns : array<BR> Args    : gene_id<BR> Warnings: <BR> Todo   : Introduce checks, modify to the current DB schema<BR></pre>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_get_all_gene_locations"></A><A NAME="POD3"></A><B>get_all_gene_locations</B></TD><TD><A HREF="#CODE3">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD><A HREF="#POD2">prev</A></TD><TD><A HREF="#POD4">next</A></TD></TR></TABLE>
<pre> Usage   : <BR> Function : Get all Bioperl objects out of the database for all CREs, asscoiated with the target gene<BR> Returns : array of Bio::Matrix::PSM::InstanceSite<BR> Args    : DB_source_id, gene accession number<BR> Warnings: <BR> Todo   : Introduce checks, test<BR></pre>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_get_analysis_id_by_gene"></A><A NAME="POD4"></A><B>get_analysis_id_by_gene</B></TD><TD><A HREF="#CODE4">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD><A HREF="#POD3">prev</A></TD><TD><A HREF="#POD5">next</A></TD></TR></TABLE>
<pre> Usage   : <BR> Returns : array of analysis_id<BR> Args    : Gene accession number<BR> Warnings: <BR> Todo   : Introduce checks, test<BR></pre>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_get_gene_by_regseq"></A><A NAME="POD5"></A><B>get_gene_by_regseq</B></TD><TD><A HREF="#CODE5">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD><A HREF="#POD4">prev</A></TD><TD><A HREF="#POD6">next</A></TD></TR></TABLE>
<pre> Usage   : <BR> Returns : gene's accession number, description and database source id<BR> Args    : reg_seq primary key<BR> Warnings: <BR> Todo   : Introduce checks<BR></pre>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_get_psms_by_accn"></A><A NAME="POD6"></A><B>get_psms_by_accn</B></TD><TD><A HREF="#CODE6">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD><A HREF="#POD5">prev</A></TD><TD><A HREF="#POD7">next</A></TD></TR></TABLE>
<pre> Function : Gets all known req_seq entries+ any relevant localization information that is considered to belong<BR>            to the target gene<BR> Usage   : <BR> Returns : regdb object, reference to an array of Bio::Matrix::PSM::InstanceSite objects<BR> Args    :  Valid gene accession number<BR> Warnings: <BR> Todo   : Introduce checks, add database source, return project_id as well, query should be restricted only to<BR>            open projects. Adapt to the new schema.<BR></pre>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD WIDTH="200"><A NAME="_pod_store_gene_data"></A><A NAME="POD7"></A><B>store_gene_data</B></TD><TD><A HREF="#CODE7">code</A></TD><TD><A HREF="#TOP">top</A></TD><TD><A HREF="#POD6">prev</A></TD><TD><A HREF="#POD8">next</A></TD></TR></TABLE>
<pre> Usage   : regdb-&gt;store_gene_data($dbname,$dbsubset,$dbaccn,$gdesc)<BR> Returns : gene_source primary key for the new record<BR> Args    : Database name and subset, followed by the gene identifier and description<BR> Warnings: <BR> Todo   : Introduce checks<BR></pre>
<A NAME="MethCode"></A>
<HR><H2>Methods code</H2>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE1"></A><B>_get_regseq_data_by_transcr_id</B></TD><TD><A HREF="#POD1">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30">prev</TD><TD WIDTH="30"><A HREF="#CODE2">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_get_regseq_data_by_transcr_id</b></font>
 {<pre><font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>,<font color="#1f32ff">$id</font><font color="#0000ff"><b>)</b></font>=<font color="#1f32ff">@_</font>;
    <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>current_handle<font color="#0000ff"><b>}</b></font>=<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>dbh<font color="#0000ff"><b>}</b></font>-&gt;<font color="#ff8204">prepare</font><font color="#0000ff"><b>(</b></font><font color="#007400">"select * from reg_seq where transcript_id=?"</font><font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>current_handle<font color="#0000ff"><b>}</b></font>-&gt;<font color="#ff8204">execute</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$id</font><font color="#0000ff"><b>)</b></font>;<font color="#ff0000">##Natural unique constraints???</font><BR>    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>current_handle<font color="#0000ff"><b>}</b></font>-&gt;fetchall_arrayref;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE2"></A><B>_get_transcript_data_by_gene_id</B></TD><TD><A HREF="#POD2">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE1">prev</A></TD><TD WIDTH="30"><A HREF="#CODE3">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff00ff"><b>_get_transcript_data_by_gene_id</b></font>
 {<pre><font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>,<font color="#1f32ff">$id</font><font color="#0000ff"><b>)</b></font>=<font color="#1f32ff">@_</font>;
    <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>current_handle<font color="#0000ff"><b>}</b></font>=<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>dbh<font color="#0000ff"><b>}</b></font>-&gt;<font color="#ff8204">prepare</font><font color="#0000ff"><b>(</b></font><font color="#007400">"select * from transcript where gene_id=?"</font><font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>current_handle<font color="#0000ff"><b>}</b></font>-&gt;<font color="#ff8204">execute</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$id</font><font color="#0000ff"><b>)</b></font>;<font color="#ff0000">##Natural unique constraints???</font><BR>    <font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>current_handle<font color="#0000ff"><b>}</b></font>-&gt;fetchall_arrayref;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE3"></A><B>get_all_gene_locations</B></TD><TD><A HREF="#POD3">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE2">prev</A></TD><TD WIDTH="30"><A HREF="#CODE4">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>get_all_gene_locations</b></font>
 {<pre><font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>,<font color="#1f32ff">$dbsrc</font>,<font color="#1f32ff">$accn</font><font color="#0000ff"><b>)</b></font>=<font color="#1f32ff">@_</font>;
<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>handle<font color="#0000ff"><b>}</b></font>=<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>dbh<font color="#0000ff"><b>}</b></font>-&gt;<font color="#ff8204">prepare</font><font color="#0000ff"><b>(</b></font><font color="#007400">"select distinct gene_id from gene_source where DB_source_id=? and DB_accn=?"</font><font color="#0000ff"><b>)</b></font>||<font color="#4169e1"><b>die</b></font> <font color="#1f32ff">$DBI</font>::errstr;
<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>handle<font color="#0000ff"><b>}</b></font>-&gt;<font color="#ff8204">execute</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$dbsrc</font>,<font color="#1f32ff">$accn</font><font color="#0000ff"><b>)</b></font>||<font color="#4169e1"><b>die</b></font> <font color="#1f32ff">$DBI</font>::errstr;
<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>transcript_handle<font color="#0000ff"><b>}</b></font>=<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>dbh<font color="#0000ff"><b>}</b></font>-&gt;<font color="#ff8204">prepare</font><font color="#0000ff"><b>(</b></font><font color="#007400">"select distinct transcript_id from transcript where gene_id=?"</font><font color="#0000ff"><b>)</b></font>||<font color="#4169e1"><b>die</b></font> <font color="#1f32ff">$DBI</font>::errstr;
<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$psm</font>;
<font color="#0000ff"><b>while</b></font> <font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$id</font>=<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>handle<font color="#0000ff"><b>}</b></font>-&gt;fetchrow_array<font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@dat</font>=<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">get_data_by_primary_key</font><font color="#0000ff"><b>(</b></font><font color="#007400">'gene'</font>,<font color="#1f32ff">$id</font><font color="#0000ff"><b>)</b></font>;
    <font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>transcript_handle<font color="#0000ff"><b>}</b></font>-&gt;<font color="#ff8204">execute</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$id</font><font color="#0000ff"><b>)</b></font>||<font color="#4169e1"><b>die</b></font> <font color="#1f32ff">$DBI</font>::errstr;
    <font color="#0000ff"><b>while</b></font> <font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$tid</font>=<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>transcript_handle<font color="#0000ff"><b>}</b></font>-&gt;fetchrow_array<font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
        <font color="#4169e1"><b>print</b></font> <font color="#4169e1"><b>join</b></font><font color="#0000ff"><b>(</b></font><font color="#007400">':'</font>,<font color="#007400">'debug data'</font>,<font color="#1f32ff">$tid</font>,<font color="#1f32ff">$dat</font><font color="#0000ff"><b>[</b></font>1<font color="#0000ff"><b>]</b></font>,<font color="#1f32ff">$accn</font>,<font color="#007400">'end'</font><font color="#0000ff"><b>)</b></font>;
        <font color="#4169e1"><b>push</b></font> <font color="#1f32ff">@psm</font>,<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">get_psm_by_transcript_coordinates</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$tid</font>,<font color="#1f32ff">$dat</font><font color="#0000ff"><b>[</b></font>1<font color="#0000ff"><b>]</b></font>,<font color="#1f32ff">$accn</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>}</b></font>
<font color="#0000ff"><b>}</b></font>
<font color="#0000ff"><b>return</b></font> <font color="#1f32ff">@psm</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE4"></A><B>get_analysis_id_by_gene</B></TD><TD><A HREF="#POD4">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE3">prev</A></TD><TD WIDTH="30"><A HREF="#CODE5">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>get_analysis_id_by_gene</b></font>
 {<pre><font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>,<font color="#1f32ff">$accn</font><font color="#0000ff"><b>)</b></font>=<font color="#1f32ff">@_</font>;
<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>current_handle<font color="#0000ff"><b>}</b></font>=<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>dbh<font color="#0000ff"><b>}</b></font>-&gt;<font color="#ff8204">prepare</font><font color="#0000ff"><b>(</b></font><font color="#007400">"select * from gene_source where DB_accn=?"</font><font color="#0000ff"><b>)</b></font>;
<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>current_handle<font color="#0000ff"><b>}</b></font>-&gt;<font color="#ff8204">execute</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$accn</font><font color="#0000ff"><b>)</b></font>;<font color="#ff0000">##Natural unique constraints???</font><BR><font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$all</font>=<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>current_handle<font color="#0000ff"><b>}</b></font>-&gt;fetchall_arrayref;
<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@res</font>;
<font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$row</font> <font color="#0000ff"><b>(</b></font>@$all<font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$gsid</font>,<font color="#1f32ff">$geneid</font>,<font color="#1f32ff">$dbsrcid</font>,<font color="#1f32ff">$dbaccn</font>,<font color="#1f32ff">$date</font>,<font color="#1f32ff">$proj</font><font color="#0000ff"><b>)</b></font>=@$row;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@dbsource</font>=<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">get_data_by_primary_key</font><font color="#0000ff"><b>(</b></font><font color="#007400">'DB_source'</font>,<font color="#1f32ff">$dbsrcid</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@gene</font>=<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">get_data_by_primary_key</font><font color="#0000ff"><b>(</b></font><font color="#007400">'gene'</font>,<font color="#1f32ff">$geneid</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$tdata</font>=<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_get_transcript_data_by_gene_id</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$geneid</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$row</font> <font color="#0000ff"><b>(</b></font>@$tdata<font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
        <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$tid</font>,<font color="#1f32ff">$gid</font>,<font color="#1f32ff">$dbsrcid</font>,<font color="#1f32ff">$dbaccn</font>,<font color="#1f32ff">$form</font>,<font color="#1f32ff">$comment</font><font color="#0000ff"><b>)</b></font>=@$row;
        <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$rseqdat</font>=<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_get_regseq_data_by_transcr_id</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$tid</font><font color="#0000ff"><b>)</b></font>;
        <font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$rseqrow</font> <font color="#0000ff"><b>(</b></font>@$rseqdat<font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
            <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$rsid</font>,<font color="#1f32ff">$tfbs</font>,<font color="#1f32ff">$trid</font>,<font color="#1f32ff">$coordid</font>,<font color="#1f32ff">$seq</font>,<font color="#1f32ff">$qual</font>,<font color="#1f32ff">$cdate</font>,<font color="#1f32ff">$cproj</font><font color="#0000ff"><b>)</b></font>=@$rseqrow;
            <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@io</font>=<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">get_IO_type_id</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$rsid</font>,<font color="#007400">'reg_seq'</font><font color="#0000ff"><b>)</b></font>;
            <font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$io</font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">@io</font><font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
                <font color="#1f32ff">@aid</font>=<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">get_analysis_data_by_IO</font><font color="#0000ff"><b>(</b></font>\<font color="#1f32ff">@io</font><font color="#0000ff"><b>)</b></font>;
                <font color="#4169e1"><b>push</b></font> <font color="#1f32ff">@res</font>,<font color="#1f32ff">@aid</font>;
    <font color="#0000ff"><b>}</b></font>
<font color="#0000ff"><b>}</b></font>
<font color="#0000ff"><b>}</b></font>
<font color="#0000ff"><b>}</b></font>
<font color="#0000ff"><b>return</b></font> <font color="#1f32ff">@res</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE5"></A><B>get_gene_by_regseq</B></TD><TD><A HREF="#POD5">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE4">prev</A></TD><TD WIDTH="30"><A HREF="#CODE6">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>get_gene_by_regseq</b></font>
 {<pre><font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>,<font color="#1f32ff">$id</font><font color="#0000ff"><b>)</b></font>=<font color="#1f32ff">@_</font>;
<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$sth</font>=<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">prepare</font><font color="#0000ff"><b>(</b></font><font color="#007400">"select distinct gene_source_id from TSR_reg_seq a, TSR b where reg_seq_id='$id'
                        and a.TSR_id=b.TSR_id"</font><font color="#0000ff"><b>)</b></font>;
<font color="#1f32ff">$sth</font>-&gt;execute||die;
<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$gid</font>=<font color="#1f32ff">$sth</font>-&gt;fetchrow_array;
<font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$dbsrc</font>,<font color="#1f32ff">$accn</font>,<font color="#1f32ff">$desc</font><font color="#0000ff"><b>)</b></font>=&gt;<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">get_data_by_primary_key</font><font color="#0000ff"><b>(</b></font><font color="#007400">'gene_source'</font>,<font color="#1f32ff">$gid</font><font color="#0000ff"><b>)</b></font>;
<font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$accn</font>,<font color="#1f32ff">$desc</font>,<font color="#1f32ff">$dbsrc</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE6"></A><B>get_psms_by_accn</B></TD><TD><A HREF="#POD6">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE5">prev</A></TD><TD WIDTH="30"><A HREF="#CODE7">next</A></TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>get_psms_by_accn</b></font>
 {<pre><font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>,<font color="#1f32ff">$accn</font><font color="#0000ff"><b>)</b></font>=<font color="#1f32ff">@_</font>;
<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@psms</font>;
<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>current_handle<font color="#0000ff"><b>}</b></font>=<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>dbh<font color="#0000ff"><b>}</b></font>-&gt;<font color="#ff8204">prepare</font><font color="#0000ff"><b>(</b></font><font color="#007400">"select * from gene_source where DB_accn=?"</font><font color="#0000ff"><b>)</b></font>;
<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>current_handle<font color="#0000ff"><b>}</b></font>-&gt;<font color="#ff8204">execute</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$accn</font><font color="#0000ff"><b>)</b></font>;<font color="#ff0000">##Natural unique constraints???</font><BR><font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$all</font>=<font color="#1f32ff">$self</font>-&gt;<font color="#0000ff"><b>{</b></font>current_handle<font color="#0000ff"><b>}</b></font>-&gt;fetchall_arrayref;
<font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$row</font> <font color="#0000ff"><b>(</b></font>@$all<font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
    <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$gsid</font>,<font color="#1f32ff">$geneid</font>,<font color="#1f32ff">$dbsrcid</font>,<font color="#1f32ff">$dbaccn</font>,<font color="#1f32ff">$date</font>,<font color="#1f32ff">$proj</font><font color="#0000ff"><b>)</b></font>=@$row;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@dbsource</font>=<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">get_data_by_primary_key</font><font color="#0000ff"><b>(</b></font><font color="#007400">'DB_source'</font>,<font color="#1f32ff">$dbsrcid</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@gene</font>=<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">get_data_by_primary_key</font><font color="#0000ff"><b>(</b></font><font color="#007400">'gene'</font>,<font color="#1f32ff">$geneid</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$tdata</font>=<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_get_transcript_data_by_gene_id</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$geneid</font><font color="#0000ff"><b>)</b></font>;
    <font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$row</font> <font color="#0000ff"><b>(</b></font>@$tdata<font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
        <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$tid</font>,<font color="#1f32ff">$gid</font>,<font color="#1f32ff">$dbsrcid</font>,<font color="#1f32ff">$dbaccn</font>,<font color="#1f32ff">$form</font>,<font color="#1f32ff">$comment</font><font color="#0000ff"><b>)</b></font>=@$row;
        <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$rseqdat</font>=<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">_get_regseq_data_by_transcr_id</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$tid</font><font color="#0000ff"><b>)</b></font>;
        <font color="#0000ff"><b>foreach</b></font> <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$rseqrow</font> <font color="#0000ff"><b>(</b></font>@$rseqdat<font color="#0000ff"><b>)</b></font> <font color="#0000ff"><b>{</b></font>
            <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$rsid</font>,<font color="#1f32ff">$tfbs</font>,<font color="#1f32ff">$trid</font>,<font color="#1f32ff">$coordid</font>,<font color="#1f32ff">$seq</font>,<font color="#1f32ff">$qual</font>,<font color="#1f32ff">$cdate</font>,<font color="#1f32ff">$cproj</font><font color="#0000ff"><b>)</b></font>=@$rseqrow;
            <font color="#1f32ff">$seq</font>=~s<font color="#006400"><b>/\W/</b></font><font color="#006400"><b>/g; #Fix for non-comparible data, EOL, etc.<BR>            my </b></font><font color="#1f32ff">@coord</font><font color="#006400"><b>=</b></font><font color="#1f32ff">$self</font><font color="#006400"><b>-&gt;get_data_by_primary_key('coordinate',</b></font><font color="#1f32ff">$coordid</font>);<BR>            <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">@loc</font>=<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">get_data_by_primary_key</font><font color="#0000ff"><b>(</b></font><font color="#007400">'location'</font>,<font color="#1f32ff">$coord</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font><font color="#0000ff"><b>)</b></font>;
            <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$psm</font>=<font color="#0000ff"><b>new</b></font> <font color="#8000ff"><b>Bio::Matrix::PSM</b></font>::<font color="#ff8204">InstanceSite</font><font color="#0000ff"><b>(</b></font>-start=&gt;<font color="#1f32ff">$coord</font><font color="#0000ff"><b>[</b></font>2<font color="#0000ff"><b>]</b></font>,-end=&gt;<font color="#1f32ff">$coord</font><font color="#0000ff"><b>[</b></font>3<font color="#0000ff"><b>]</b></font>,-strand=&gt;<font color="#1f32ff">$coord</font><font color="#0000ff"><b>[</b></font>4<font color="#0000ff"><b>]</b></font>, -accession_number=&gt;<font color="#1f32ff">$coordid</font>,
                                            -desc=&gt;<font color="#1f32ff">$gene</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>, -anchor=&gt;<font color="#1f32ff">$loc</font><font color="#0000ff"><b>[</b></font>4<font color="#0000ff"><b>]</b></font>, -seq=&gt;<font color="#1f32ff">$seq</font>, -id=&gt;<font color="#1f32ff">$gene</font><font color="#0000ff"><b>[</b></font>2<font color="#0000ff"><b>]</b></font><font color="#0000ff"><b>)</b></font>;
            <font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$gen</font>,<font color="#1f32ff">$species</font><font color="#0000ff"><b>)</b></font>=<font color="#4169e1"><b>split</b></font><font color="#0000ff"><b>(</b></font><font color="#006400"><b>/\s/</b></font>,<font color="#1f32ff">$loc</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font><font color="#0000ff"><b>)</b></font>;
            <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$sp</font>=<font color="#0000ff"><b>new</b></font> <font color="#8000ff"><b>Bio</b></font>::<font color="#ff8204">Species</font><font color="#0000ff"><b>(</b></font>-classification=&gt;<font color="#0000ff"><b>[</b></font><font color="#1f32ff">$species</font>,<font color="#1f32ff">$gen</font><font color="#0000ff"><b>]</b></font><font color="#0000ff"><b>)</b></font>;
            <font color="#1f32ff">$psm</font>-&gt;<font color="#ff8204">species</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$sp</font><font color="#0000ff"><b>)</b></font>;
            <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$dblink</font>= <font color="#0000ff"><b>new</b></font> <font color="#8000ff"><b>Bio::Annotation</b></font>::<font color="#ff8204">DBLink</font><font color="#0000ff"><b>(</b></font>-database=&gt;<font color="#1f32ff">$dbsource</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>,-namespace=&gt;<font color="#1f32ff">$dbsource</font><font color="#0000ff"><b>[</b></font>0<font color="#0000ff"><b>]</b></font>,-primary_id=&gt;<font color="#1f32ff">$tid</font>,-version=&gt;<font color="#1f32ff">$form</font>,
                                        -optional_id=&gt;<font color="#1f32ff">$accn</font><font color="#0000ff"><b>)</b></font>;
            <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$comm</font>= <font color="#0000ff"><b>new</b></font> <font color="#8000ff"><b>Bio::Annotation</b></font>::<font color="#ff8204">Comment</font><font color="#0000ff"><b>(</b></font>-text=&gt;<font color="#1f32ff">$tdata</font><font color="#0000ff"><b>[</b></font>4<font color="#0000ff"><b>]</b></font><font color="#0000ff"><b>)</b></font>;
            <font color="#1f32ff">$dblink</font>-&gt;<font color="#ff8204">comment</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$comm</font><font color="#0000ff"><b>)</b></font>;
            <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$ann</font>= <font color="#0000ff"><b>new</b></font> <font color="#8000ff"><b>Bio::Annotation</b></font>::<font color="#ff8204">Collection</font><font color="#0000ff"><b>(</b></font><font color="#0000ff"><b>)</b></font>;
            <font color="#1f32ff">$ann</font>-&gt;<font color="#ff8204">add_Annotation</font><font color="#0000ff"><b>(</b></font><font color="#007400">'dblink'</font>,<font color="#1f32ff">$dblink</font><font color="#0000ff"><b>)</b></font>;
            <font color="#1f32ff">$psm</font>-&gt;<font color="#ff8204">annotation</font><font color="#0000ff"><b>(</b></font><font color="#1f32ff">$ann</font><font color="#0000ff"><b>)</b></font>;
            <font color="#4169e1"><b>push</b></font> <font color="#1f32ff">@psms</font>,<font color="#1f32ff">$psm</font>;
        <font color="#0000ff"><b>}</b></font>
    <font color="#0000ff"><b>}</b></font>
<font color="#0000ff"><b>}</b></font>
<font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$self</font>,\<font color="#1f32ff">@psms</font>;</pre>}<BR>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#dcab68"><TD WIDTH="200"><A NAME="CODE7"></A><B>store_gene_data</B></TD><TD><A HREF="#POD7">description</A></TD><TD WIDTH="30"><A HREF="#TOP">top</A></TD><TD WIDTH="30"><A HREF="#CODE6">prev</A></TD><TD WIDTH="30">next</TD></TR></TABLE>
<font color="#0000ff"><b>sub</b></font> <font color="#ff0000"><b>store_gene_data</b></font>
 {<pre><font color="#0000ff"><b>my</b></font> <font color="#0000ff"><b>(</b></font><font color="#1f32ff">$self</font>,<font color="#1f32ff">$dbname</font>,<font color="#1f32ff">$dbsubset</font>,<font color="#1f32ff">$dbaccn</font>,<font color="#1f32ff">$gdesc</font><font color="#0000ff"><b>)</b></font>=<font color="#1f32ff">@_</font>; 
 <font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$dbsrcid</font>=<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">table_insert</font><font color="#0000ff"><b>(</b></font><font color="#007400">'DB_source'</font>,<font color="#1f32ff">$dbname</font>,<font color="#1f32ff">$dbsubset</font><font color="#0000ff"><b>)</b></font>;
<font color="#0000ff"><b>my</b></font> <font color="#1f32ff">$gsrcid</font>=<font color="#1f32ff">$self</font>-&gt;<font color="#ff8204">table_insert</font><font color="#0000ff"><b>(</b></font><font color="#007400">'gene_source'</font>,<font color="#1f32ff">$dbsrcid</font>,<font color="#1f32ff">$dbaccn</font>,<font color="#1f32ff">$gdesc</font><font color="#0000ff"><b>)</b></font>;
<font color="#0000ff"><b>return</b></font> <font color="#1f32ff">$gsrcid</font>;</pre>}<BR>
<A NAME="General"></A>
<HR><H2>General documentation</H2>
<TABLE BORDER="0" WIDTH="100%" CELLSPACING="0">
<TR BGCOLOR="#4492df"><TD><A NAME="_pod_To do"><B>To do</A></B></TD>
<TD><A HREF="#TOP">top</A></TD></TR><TR><TD COLSPAN="2"><pre></pre>
</TD></TR>
</TABLE>
</body>
</html>
